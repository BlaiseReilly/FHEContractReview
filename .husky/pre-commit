#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Run Prettier formatting check
echo "ğŸ“ Checking code formatting..."
npm run format:check || {
  echo "âŒ Code formatting check failed!"
  echo "ğŸ’¡ Run 'npm run format' to fix formatting issues"
  exit 1
}

# Run Solhint
echo "ğŸ”’ Running Solidity linter..."
npm run lint:sol || {
  echo "âŒ Solidity linting failed!"
  echo "ğŸ’¡ Fix linting issues before committing"
  exit 1
}

# Run ESLint
echo "ğŸ” Running JavaScript linter..."
npm run lint:js || {
  echo "âš ï¸  JavaScript linting warnings detected"
  # Don't fail on warnings, just notify
}

# Compile contracts to ensure they're valid
echo "âš™ï¸  Compiling contracts..."
npm run compile || {
  echo "âŒ Contract compilation failed!"
  exit 1
}

# Run tests (optional - can be commented out for faster commits)
# Uncomment the following lines to run tests before every commit
# echo "ğŸ§ª Running tests..."
# npm test || {
#   echo "âŒ Tests failed!"
#   exit 1
# }

echo "âœ… Pre-commit checks passed!"
echo "ğŸ“¦ Ready to commit"
